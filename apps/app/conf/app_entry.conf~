 # location /app/assets {
 #     alias _APP_ROOT_/public/assets;
 # }
 
 # location /app {
 #     access_log _SITE_ROOT_/logs/app_v1-access.log;
 #    error_log _SITE_ROOT_/logs/app_v1-error.log;

 #            default_type text/html;

 #            # NOTE: we should uncomment these when doing local benchmark
 #            # or stress tests:
 #            # limit_req zone=five burst=20;
 #            # limit_conn addr 20;

 #            content_by_lua_block {
 #                require("app").go()
 #            }
 #        }
	
location /app {
    access_log _SITE_ROOT_/logs/app_v1-access.log;
    error_log _SITE_ROOT_/logs/app_v1-error.log;

    index index.html;
    alias _APP_ROOT_/public;
}
location /api/app/v1 {
    access_log _SITE_ROOT_/logs/app_v1-access.log;
    error_log _SITE_ROOT_/logs/app_v1-error.log;
    # allow 127.0.0.1;
    # deny all;
    set $app_root _APP_ROOT_;
    default_type application/json;
    limit_except OPTIONS POST GET {
        deny all;
    }
    content_by_lua 'nginxBootstrap:runapp("_APP_ROOT_")';
}
